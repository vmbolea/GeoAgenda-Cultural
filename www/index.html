<!DOCTYPE html>
<html>
        <head>
          <title>GeoAgenda Cultural</title> 
          <meta charset="utf-8">
          <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
          <meta name="description" content="TFM de Víctor Martínez Bolea (Noviembre 2020)">
          <meta name="viewport" content="width=device-width, initial-scale=1">
          <!-- enlace a Bootstrap v3.3.7 en directorio -->
          <link rel="stylesheet" href="js/bootstrap/css/bootstrap.min.css" >
          <!-- enlace a Bootstrap v3.3.7 en la nube -->
          <!--  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"> -->
          <!-- enlace a CSS de Leaflet  Leaflet 1.7.1 en el directorio -->
          <link rel="stylesheet" href="js/leaflet.css"/>
          <!-- enlace a CSS de Leaflet  Leaflet 1.7.1 en la nube -->
          <!--  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
          integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
          crossorigin=""/> -->
          <!-- enlace a CSS de Control.Window Leaflet   en el directorio -->
                <link rel="stylesheet" href="js/L.Control.Window.css"/>
          <!-- enlace a CSS de Control.Window Leaflet   en la nube -->    
          <!--     <link rel="stylesheet" href="https://rawgit.com/mapshakers/leaflet-control-window/master/src/L.Control.Window.css"> -->   
          <!-- enlace a los estilos de salida de datos css -->
          <link href="estilos/style_out.css" rel="stylesheet" type="text/css" />              
        </head>
        <body>
          <!-- barra de navegación superior fija -->
          <nav class="navbar navbar-default navbar-fixed-top"> 
            <div class="container">
              <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">GeoAgenda Cultural</a>
              </div>
      <div id="navbar" class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
          <li><a href='registro.php'>Registrar evento</a></li> <!-- botón para registrar evento -->
          <li><a href='historico.html'>Histórico</a></li> <!-- botón para ver histórico -->
          <li><a href='about.html'>Acerca de</a></li> <!-- botón para ver créditos -->
          <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Filtros <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><input type="radio" id="radiotodas"  name= "filtro" checked> Todos los eventos</li> <!-- botón tipo de filtro -->
            <li class="dropdown-header">Temáticos</li><!-- tipo de filtro temático -->
            <li><input type="radio" id="radioartistico" name= "filtro" > Artísticos  <!-- botón tipo de filtro -->
              <img src="js/images/ARTISTICO.svg" alt="artistico" width="35" height="35" style="vertical-align:middle"> </li><!-- imagen del tipo de filtro -->
            <li><input type="radio" id="radiodeportivo" name= "filtro" > Deportivos <!-- botón tipo de filtro -->
              <img src="js/images/DEPORTES.svg" alt="deportivo" width="35" height="35" style="vertical-align:middle"> </li><!-- imagen del tipo de filtro -->
            <li><input type="radio" id="radioformativo"name= "filtro"> Formativos  <!-- botón tipo de filtro -->
              <img src="js/images/FORMATIVO.svg" alt="formativo" width="35" height="35" style="vertical-align:middle"> </li><!-- imagen del tipo de filtro -->
            <li><input type="radio" id="radiomedioambiental"name= "filtro"  > Medioambientales <!-- botón tipo de filtro -->
              <img src="js/images/MEDIOAMBIENTAL.svg" alt="medioambiental" width="35" height="35" style="vertical-align:middle"></li><!-- imagen del tipo de filtro -->
            <li><input type="radio" id="radiorevindicativo" name= "filtro" > Reivindicativos <!-- botón tipo de filtro -->
              <img src="js/images/REIVINDICATIVO.svg" alt="revindicativo" width="35" height="35" style="vertical-align:middle"></li><!-- imagen del tipo de filtro -->
            <li role="separator" class="divider"></li>
            <li class="dropdown-header">Temporales <!-- tipo de filtro temporal -->
              <img src="js/images/TIEMPO.svg" alt="temporal" width="35" height="35" style="vertical-align:middle"></li><!-- imagen del tipo de filtro -->
            <li><input type="radio" id="radio24" name= "filtro"  > Próximas 24h</li> <!-- botón tipo de filtro -->
            <li><input type="radio" id="radio48" name= "filtro"   > Próximas 48h</li><!-- botón tipo de filtro -->
            <li><input type="radio" id="radiosemana"name= "filtro"  > Próxima semana</li><!-- botón tipo de filtro -->
            <li role="separator" class="divider"></li>
            <li class="dropdown-header">Espaciales <!-- tipo de filtro espacial -->
              <img src="js/images/DISTANCIA.svg" alt="espacial" width="35" height="35" style="vertical-align:middle"></li><!-- imagen del tipo de filtro -->
            <li><input type="radio" id="radiounokm" name= "filtro"  > En 1 km</li><!-- botón tipo de filtro -->
            <li><input type="radio" id="radiodoskm" name= "filtro"   > En 2 km</li><!-- botón tipo de filtro -->
            <li><input type="radio" id="radiocincokm"name= "filtro"  > En 5 km</li><!-- botón tipo de filtro -->
          </ul>
        </li>
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</nav>
<!-- inicio contenedor del mapa -->
            <div id="container" class="container-fluid">
              <div id="mapid"></div>
            </div>              
        </body>
          <!-- enlace a jquery-3.5.1 en el directorio -->
            <script src="js/jquery-3.5.1.min.js" type="text/javascript"></script>
          <!-- enlace a jquery-3.5.1 en la nube -->
            <!-- <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>-->
          <!-- enlace a Bootstrap v3.3.7 en la nube -->
            <script src=js\bootstrap\js\bootstrap.min.js type="text/javascript"></script>
          <!-- enlace a Bootstrap v3.3.7 en la nube -->
            <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script> -->               
          <!-- enlace a JavaScript de Leaflet 1.7.1 en el directorio -->
            <script src="js/leaflet.js"></script>
          <!-- enlace a JavaScript de Leaflet 1.7.1 en la nube -->
            <!-- <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>-->
          <!-- enlace a Control.Window Leaflet   en el directorio -->
            <script src="js/L.Control.Window.js"></script>
          <!-- enlace a Control.Window Leaflet en la nube -->
            <!-- <script src="https://rawgit.com/mapshakers/leaflet-control-window/master/src/L.Control.Window.js"></script> -->
          <!-- enlace a Turf.js   en el directorio -->
            <script src="js/turf.min.js" charset="utf-8"></script>
          <!-- enlace a Turf.js en la nube -->
            <!--  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@5/turf.min.js"></script> -->
                    

        <script type="text/javascript">
        
        // definición de la variable del mapa
          var visor = L.map('mapid').locate({setView: true, maxZoom: 15}); // clase l.map con referencia al id del contenedor y niveles de zoom
  
         // definición ventana emergente con l.control.window
          var winOpts = L.control.window(visor,{
            title:'<p style="text-align:center">Trabajo fin de Máster </p>',
            content:'<p style="text-align:center"><img src="js/images/logo.svg" title="#GeoAgenda Cultural" width="300"></p>'+
            '<p style="text-align:center"><b>Autor:</b> Víctor Martínez Bolea'+
            '<p style="text-align:center"><b>Título:</b> Elaboración de una plataforma web colaborativa con información geográfica voluntaria para articular procesos de SIG participativo</p>'+
            '<p style="text-align:center"><b>Director:</b> Miguel Sevilla-Callejo</p>'+
            '<p style="text-align:center"><b>Titulación:</b> Tecnologías de la Información Geográfica para la Ordenación del Territorio: Sistemas de Información Geográfica y Teledetección</p>'+ 
            '<p style="text-align:center"><b>Fecha:</b> Noviembre, 2020</p>',
            visible: true});

        // definición de la imagen del mapa base de OSM  añadida al mapa 
            var osmUrl ='http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'; // variable con url del mapa base
            var osmAttrib='&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors' // variable con la atribución
            var osm = new L.TileLayer(osmUrl, {attribution: osmAttrib}); // variable con la capa creada a partir de url y atribución
             osm.addTo(visor); // añadir capa al mapa

        // definición de la imagen escala  
             L.control.scale({ // clase leaflet de escala
              position: 'bottomleft', // posición de la escala
              imperial: false}) // escala métrica
            .addTo(visor); // añadir al mapa

        // definición de la fecha y hora actuales
            var today = new Date(); // se genera la fecha actual
            var ahora = today.toISOString(); // se formatea para ISO

        // definición de la url sobre la que se realizan las peticiones
            var evento = 'https://libregeo.unizar.es/geoserver/evento/ows'; // directorio al espacio de trabajo del geoserver
            var parametros_def = { // definición de los parámetros de la consulta
               service: 'WFS', // tipo de servicio
               version: '2.17.1', // versión geoserver
               request: 'GetFeature', // tipo de petición
               typeName: 'evento',  // nombre de la capa
               cql_filter:'final_evento AFTER '+ahora+'', // definición filtro
               outputFormat: 'application/json' // formato de salida
                };
            var parametros_evento = L.Util.extend(parametros_def); //cración de url para los parámetros      
            var URL = evento + L.Util.getParamString(parametros_evento); // definición de la url con la unión del directorio principal + los parámetros

       // definición de la función que determina el tipo de marcador en base a la categoría del evento
            var pt = function (json, latlng){ // función pointtolayer
            var att =json.properties; // se declara para acortar su análisis
              if(att.tipo_evento== 1) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/ARTISTICO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                      } 
              else if (att.tipo_evento== 2) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/ARTISTICO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            } 
              else if (att.tipo_evento== 3) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/ARTISTICO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }
              else if (att.tipo_evento== 4) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/ARTISTICO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }
              else if (att.tipo_evento== 5) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/ARTISTICO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }
              else if (att.tipo_evento== 6) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/ARTISTICO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }
              else if (att.tipo_evento== 7) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/ARTISTICO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }
              else if (att.tipo_evento== 8) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/ARTISTICO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }
              else if (att.tipo_evento== 9) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/ARTISTICO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }
              else if (att.tipo_evento== 10) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/ARTISTICO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }
              else if (att.tipo_evento== 11) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/DEPORTES.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }
              else if (att.tipo_evento== 12) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/DEPORTES.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }
              else if (att.tipo_evento== 13) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/DEPORTES.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            } 
              else if (att.tipo_evento== 14) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/DEPORTES.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }   
              else if (att.tipo_evento== 15) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/DEPORTES.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }
              else if (att.tipo_evento== 16) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/DEPORTES.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            } 
              else if (att.tipo_evento== 17) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/FORMATIVO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            } 
              else if (att.tipo_evento== 18) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/FORMATIVO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }  
              else if (att.tipo_evento== 19) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/FORMATIVO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }   
              else if (att.tipo_evento== 20) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/FORMATIVO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            } 
              else if (att.tipo_evento== 21) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/FORMATIVO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }    
              else if (att.tipo_evento== 22) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/FORMATIVO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            } 
              else if (att.tipo_evento== 23) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/MEDIOAMBIENTAL.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            } 
              else if (att.tipo_evento== 24) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/MEDIOAMBIENTAL.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            } 
              else if (att.tipo_evento== 25) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/REIVINDICATIVO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }  
              else if (att.tipo_evento== 26) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/REIVINDICATIVO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }     
              else if (att.tipo_evento== 27) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/REIVINDICATIVO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }  
              else if (att.tipo_evento== 28) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/REIVINDICATIVO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }  
              else if (att.tipo_evento== 29) {
                var icon_evento = 
                  new L.Icon({     // Creamos un nuevo icono
                  iconUrl: 'js/images/REIVINDICATIVO.svg', // Ruta del svg del icono
                  iconSize:     [40, 60], // tamaño del icono
                  iconAnchor:   [20, 60], // punto del icono que correspondera a la localización 
                  popupAnchor: [20, 60] // punto desde que el popup se debería abrir
                            });
                                            }   
              else {
                var icon_evento = 'black';
                    }  
              return L.marker(latlng,{icon:icon_evento}) // devuelve un marcador en la posición con el icono
                              };  // se cierra función pointtolayer

       // definición de la función que determina como se muestra la información temática mediante popup      
          var oef = function (feature, layer){ // se declara la función oneachfeature
            var tipo = ''; // se declara la variable vacía
            // se condiciona su alimentación al tipo de evento
              if (feature.properties.tipo_evento == 1) { 
                  tipo = 'Proyección';} // devuelve valor
              else if (feature.properties.tipo_evento == 2) { 
                      tipo = 'Exposición';}// devuelve valor
              else if (feature.properties.tipo_evento == 3) {
                      tipo = 'Teatro';}// devuelve valor
              else if (feature.properties.tipo_evento == 4) {
                      tipo = 'Danza';}// devuelve valor
              else if (feature.properties.tipo_evento == 5) {
                      tipo = 'Circo';}// devuelve valor
              else if (feature.properties.tipo_evento == 6) {
                      tipo = 'Festival';}// devuelve valor
              else if (feature.properties.tipo_evento == 7) {
                      tipo = 'Performance';}// devuelve valor
              else if (feature.properties.tipo_evento == 8) {
                      tipo = 'Pasacalles';}// devuelve valor
              else if (feature.properties.tipo_evento == 9) {
                      tipo = 'Encuentro';}// devuelve valor
              else if (feature.properties.tipo_evento == 10) {
                      tipo = 'Partido';}// devuelve valor
              else if (feature.properties.tipo_evento == 11) {
                      tipo = 'Quedada';}// devuelve valor  
              else if (feature.properties.tipo_evento == 12) {
                      tipo = 'Competición';} // devuelve valor 
              else if (feature.properties.tipo_evento == 13) {
                      tipo = 'Entrenamiento';}// devuelve valor 
              else if (feature.properties.tipo_evento == 14) {
                      tipo = 'Carrera';} // devuelve valor
              else if (feature.properties.tipo_evento == 15) {
                      tipo = 'Encuentro';} // devuelve valor
              else if (feature.properties.tipo_evento == 16) {
                      tipo = 'Charla';} // devuelve valor
              else if (feature.properties.tipo_evento == 17) {
                      tipo = 'Taller';} // devuelve valor
              else if (feature.properties.tipo_evento == 18) {
                      tipo = 'Curso';} // devuelve valor
              else if (feature.properties.tipo_evento == 19) {
                      tipo = 'Seminario';} // devuelve valor
              else if (feature.properties.tipo_evento == 20) {
                      tipo = 'Aseroría';} // devuelve valor
              else if (feature.properties.tipo_evento == 21) {
                      tipo = 'Aseroría';} // devuelve valor
              else if (feature.properties.tipo_evento == 22) {
                      tipo = 'Clase';} // devuelve valor
              else if (feature.properties.tipo_evento == 23) {
                      tipo = 'Excursión';} // devuelve valor
              else if (feature.properties.tipo_evento == 24) {
                      tipo = 'Batida';} // devuelve valor
              else if (feature.properties.tipo_evento == 25) {
                      tipo = 'Manifestación';} // devuelve valor
              else if (feature.properties.tipo_evento == 26) {
                      tipo = 'Concentración';} // devuelve valor
              else if (feature.properties.tipo_evento == 27) {
                      tipo = 'Acción directa';} // devuelve valor
              else if (feature.properties.tipo_evento == 28) {
                      tipo = 'Asamblea';} // devuelve valor
              else if (feature.properties.tipo_evento == 29) {
                      tipo = 'Asamblea';} // devuelve valor
              else {
                      tipo = 'Sin especificar';}; // devuelve valor

            // se declara la variable vacía
            var imagen=''; 
              // se condiciona su alimentación a la existencia de la imagen
              if (feature.properties.imagen_evento != ""){ 
                    imagen = '<a href=imagenes/'+feature.properties.imagen_evento+' ><img src=imagenes/'+feature.properties.imagen_evento+'   target="_blank" width="300" height="auto" ></a>';} // devuelve valor
              else{
                    imagen = ''}// devuelve valor

            // se declara la variable vacía
            var urlevento = '';
              // se condiciona su alimentación a la existencia de la url
              if (feature.properties.url_evento !== ""){ 
                    urlevento ='<a href="'+feature.properties.url_evento+'"  target="_blank" >'+feature.properties.url_evento+'</a>';} // devuelve valor
              else{
                    urlevento  = ''} // devuelve valor

            // se declara la variable vacía
            var precio = '';
              // se condiciona su alimentación a la existencia de un valor
              if (feature.properties.precio_evento !== null){ 
                    precio = feature.properties.precio_evento+ " €";} // devuelve valor
              else{
                    precio = 'Sin especificar'}// devuelve valor

            // se declara la variable vacía              
            var aforo = '';
              // se condiciona su alimentación a la existencia de un valor 
              if (feature.properties.aforo_evento !== null){ 
                    aforo = feature.properties.aforo_evento+ " per.";} // devuelve valor
              else{
                    aforo = 'Sin especificar'} // devuelve valor

            // se declara la variable para dar estilo al popup       
            var customOptions ={'className' : 'custom-popup'} // la clase del elemento se prefija con los estilos
            
            // se declara la variable para dar contenido al popup
                  layer.bindPopup( 
                    '<h3 style="text-align:center; font-size: 14px; color:rgb(16, 17, 17); font-weight:bold; ">'+ tipo +'</h3>'+ // variable definida arriba
                    '<br /><h1 style="text-align:center; font-size: 22px; color:rgb(16, 17, 17); font-weight:bold; ">'+feature.properties.nombre_evento +'</h1>'+ // propiedades del geojson
                    '<br /><strong >Comienza el día </strong>' +feature.properties.inicio_evento.substring(8, 10)+'/'+feature.properties.inicio_evento.substring(5, 7)+'/'+feature.properties.inicio_evento.substring(0, 4)+ '<strong> a las </strong>' + feature.properties.inicio_evento.substring(11, 16)+'<strong> horas</strong>'+ // propiedades del geojson parseadas para que salga el formato fecha
                    '<br /><strong >Termina el día </strong>' +feature.properties.final_evento.substring(8, 10)+'/'+feature.properties.final_evento.substring(5, 7)+'/'+feature.properties.final_evento.substring(0, 4)+ '<strong> a las </strong>' + feature.properties.final_evento.substring(11, 16)+'<strong> horas</strong>'+ // propiedades del geojson parseadas para que salga el formato fecha
                    '<br />'+
                    '<br />'+imagen+''+ // variable definida arriba
                    '<br />'+
                    '<br /><strong>Organizado por </strong>'+feature.properties.organizador_evento+'</strong>'+ // propiedades del geojson
                    '<br /><strong>Descripción: </strong>'+
                    '<br />'+feature.properties.descripcion_evento+''+ // propiedades del geojson
                    '<br />'+
                    '<br /><strong>Precio: </strong>'+precio+'<strong> Aforo: </strong>'+aforo+''+ // variables definidas más arriba
                    '<br />'+
                    '<br />'+urlevento+''+   // variable definida arriba
                    '<br />' 
                    ,customOptions // variable de estilos definida arriba
                                ); // se cierra variable de popup
                                  }; // se cierra función oneachfeature
             
        // definición de la variable que contendrá la clase geojson                  
          var todas;
        // se le añade una clase geojson de leaflet
              todas = L.geoJson(null, {  //se declara la clase vacía
                      pointToLayer: pt, // función pointtolayer definida más arriba
                      onEachFeature: oef, // función oneachfeature definida más arriba                                       
                        }); // se cierra el contenido de la clase geojson
                          
        // comienzan las funciones de localización y los cálculos derivados de la misma
         // se crea el icono de localización
            var where = new L.Icon({     // Creamos un nuevo icono
              iconUrl: 'js/images/usuario.svg', // Ruta del svg del icono
              iconSize: [25, 25], // Tamaño
              iconAnchor: [20, 20] // Anchor
                                    });// se cierra el icono de localización
       
          // definición de la función de localización
            function onLocationFound(e) { // función de localización
              lat = e.latlng.lat; // valor de latitud
              lng = e.latlng.lng; // valor de longitud
              var radius = e.accuracy / 2; // se obtiene el radio de la exactitud
              var center = turf.point([lng,lat]); // definición variable de punto
       
          // llamada para cargar los datos mediante una solicitud GET HTTP a la url definida más arriba.        
            $.getJSON(URL, function(data) { // función de llamada    
              var points = []; // definición array vacío
               for (var i = 0; i < data.features.length; i++) { // iteración sobre los datos cargados
                   id_evento = data.features[i].id; // definición de variable con los ids de los datos  
                   points.push(turf.point(data.features[i].geometry.coordinates, // se cargan las geometrias de los datos como puntos turf 
                     { id_evento:id_evento  })); // con su id correspondiente
                   }; // se cierra la iteración sobre los datos con el array rellenado
              var pointsCollection = turf.featureCollection(points); // se crea una colección de turf a partir del array rellenado
              var nearest = turf.nearestPoint(center, pointsCollection); // se calcula el punto más cercano desde la posición del usuario
                var distance = nearest.properties.distanceToPoint; // se obtiene la distancia al evento más cercano
                var ev_near_id = nearest.properties.id_evento; // se obtiene la id del evento más cercano     
              var circleuno = turf.circle(center, 1); // se define un cirulo de 1 km alrededor de la posición del usuario
                var pointcircleuno = turf.pointsWithinPolygon(pointsCollection, circleuno); // se calcula la cantidad de puntos en el circulo
                var pointsuno = pointcircleuno.features.length; // se obtiene la cantidad de puntos en el circulo
              var circledos = turf.circle(center, 2); // se define un cirulo de 2 km alrededor de la posición del usuario
                 var pointcircledos = turf.pointsWithinPolygon(pointsCollection, circledos); // se calcula la cantidad de puntos en el circulo
                 var pointsdos = pointcircledos.features.length; // se define un cirulo de 2 km alrededor de la posición del usuario
              var circlecinco = turf.circle(center, 5);// se define un cirulo de 5 km alrededor de la posición del usuario
                 var pointcirclecinco = turf.pointsWithinPolygon(pointsCollection, circlecinco);// se calcula la cantidad de puntos en el circulo
                 var pointscinco = pointcirclecinco.features.length;// se define un cirulo de 5 km alrededor de la posición del usuario
              var tipo = 'conexion'; // se define el tipo 
              
            // se realiza una petición asíncrona para enviar las referencias 
            $.ajax({ // función asíncrona
              url:"location.php", // archivo de destino
              method: "POST", // método de petición
              data:{lat,lng,tipo,ev_near_id,distance,pointsuno,pointsdos,pointscinco}, // datos enviados
              success: function(e){console.log(e)}
                     }); // se cierra la petición
            
          // se declara la variable para dar estilo al popup sobre la localización del usuario      
            var customOptions ={'className' : 'custom-popup'} // la clase del elemento se prefija con los estilos
            
          // se declara la variable para dar contenido al popup
            L.marker(e.latlng,{icon:where}).addTo(visor) // se añade sobre su posición con el icono previamente definido
                 .bindPopup( // se añade contenido al popup con la información calculada y obtenida más arriba
                  '<h2 style="text-align:center; font-size: 14px; color:rgb(16, 17, 17); font-weight:bold; ">Tu posición ha sido registrada</h2>'+
                  '<p style="text-align:center"> de manera <b>anónima</b> y de la que obtenemos los siguientes datos: </p>'+
                  '<p style="text-align:center"><b>Latitud: </b>'+e.latlng.lat.toFixed(5)+' <b>Longitud: </b>'+e.latlng.lng.toFixed(5)+'</p>'+
                  '<p style="text-align:center"><b>Exactitud: </b> +/-'+radius+' metros</p>'+
                  '<p style="text-align:center"><b>Distancia al evento más cercano: </b>'+(distance*1000).toFixed(2)+' metros</p>'+
                  '<p style="text-align:center"><b>ID del evento más cercano: </b>'+ev_near_id+'</p>'+
                  '<p style="text-align:center"><b>Nº de eventos en un radio de 1 km: </b>'+pointsuno+'</p>'+
                  '<p style="text-align:center"><b>Nº de eventos en un radio de 2 km: </b>'+pointsdos+'</p>'+
                  '<p style="text-align:center"><b>Nº de eventos en un radio de 5 km: </b>'+pointscinco+'</p>'+
                  '<p style="text-align:center">Datos <b>espaciales</b> son coleccionados en cada una de nuestras <b>conexiones</b> a internet, en esta plataforma se propone <b>claridad</b> sobre su uso y <b>control</b> de los usuarios sobre ellos. Para consultar los análisis espaciales derivados de estos datos o descargarlos, dirígete al apartado de <b>Hístorico</b>. </p>',
                 ).openPopup(); // se cierra el contenido del popup

          // se carga los datos provenientes de la peticion $.getJSON a la variable con la clase geojson sin datos de más arriba
            todas.addData(data); // función para añadir datos de una petición sobre una clase geojson ya definida                  
                 }); // se cierra la petición  $.getJSON
                 };  // se cierra la función de localización
                     
         // si la localización falla
         function onLocationError(e) { // función de error localización
         alert(e.message);} // mensaje de alerta si falla
         
         // se añaden las funciones de localización exitósa y erronea al mapa       
         visor.on('locationfound', onLocationFound);
         visor.on('locationerror', onLocationError);
       
         // se define la variable que contiene un grupo de capas      
        var myData =  L.layerGroup([]); // variable con grupo de capas vacío
            myData.addLayer(todas); // se añade la capa todas previamente declarada y rellenada
            myData.addTo(visor); // se añade el grupo de capas al mapa
      
  // Aquí comienza la definición del comportamiento de los eventos sobre los elementos "botones" de la barra de navegación

      // Evento para botón todas
        document.getElementById("radiotodas").addEventListener('click', function(event) {	// si se presiona el botón con el id
          myData.clearLayers(); // el grupo de capas se limpia
          visor.removeLayer(myData); // se borra el grupo de capas sobre el mapa
        // definición de la variable que contendrá la nueva clase geojson                  
        var todas;
          // se le añade una clase geojson de leaflet
          todas = L.geoJson(null, {  //se declara la clase vacía
                  pointToLayer: pt, // función pointtolayer definida más arriba
                  onEachFeature: oef, // función oneachfeature definida más arriba                                       
                        }); // se cierra el contenido de la clase geojson
        // llamada para cargar los datos mediante una solicitud GET HTTP a la url definida más arriba.        
        $.getJSON(URL, function(data) { // función de llamada  
        // se carga los datos provenientes de la peticion $.getJSON a la variable con la clase geojson sin datos de más arriba
          todas.addData(data); // función para añadir datos de una petición sobre una clase geojson ya definida                  
                 }); // se cierra la petición  $.getJSON
	      myData.addLayer(todas);// se añade la capa al grupo de capas
        myData.addTo(visor); // se añade el grupo de capas al mapa
    }); // se cierra el evento para botón todas

        // Evento para botón temático artístico
          document.getElementById("radioartistico").addEventListener('click', function(event) { // si se presiona el botón con el id
          // Definición de referencias de filtro
            var clase = 'tematico'; // clase_filtro
            var tipo = 'artistico';//tipo_filtro
          // se realiza una petición asíncrona para enviar las referencias 
              $.ajax({
                      url:"location_filtro.php", //archivo de destino
                      method: "POST", // método de petición
                      data:{lat,lng,clase,tipo}, // referencias
                      dataType:"text" // tipo de datos
                      }); // se cierra la petición asíncrona
          myData.clearLayers(); // el grupo de capas se limpia
          visor.removeLayer(myData); // se borra el grupo de capas sobre el mapa
          // definición de la variable que contendrá la nueva clase geojson                  		
            var artistico;
          // se le añade una clase geojson de leaflet
            artistico =L.geoJson(null, {  //se declara la clase vacía
                  pointToLayer: pt, // función pointtolayer definida más arriba
                  onEachFeature: oef, // función oneachfeature definida más arriba      
                  filter:function(feature, layer) { // función de filtro tipos de evento artístico
                    return (feature.properties.tipo_evento == "1"|| 
                            feature.properties.tipo_evento == "2"||
                            feature.properties.tipo_evento == "3"||
                            feature.properties.tipo_evento == "4"||
                            feature.properties.tipo_evento == "5"||
                            feature.properties.tipo_evento == "6"||
                            feature.properties.tipo_evento == "7"||
                            feature.properties.tipo_evento == "8"||
                            feature.properties.tipo_evento == "9"||
                            feature.properties.tipo_evento == "10"||
                            feature.properties.tipo_evento == "29");
			              }}); // se cierra la clase geojson
		
        // llamada para cargar los datos mediante una solicitud GET HTTP a la url definida más arriba.        
        $.getJSON(URL, function(data) { // función de llamada  
        // se carga los datos provenientes de la peticion $.getJSON a la variable con la clase geojson sin datos de más arriba
        artistico.addData(data); // función para añadir datos de una petición sobre una clase geojson ya definida                  
                 }); // se cierra la petición  $.getJSON
	      myData.addLayer(artistico);// se añade la capa al grupo de capas
        myData.addTo(visor); // se añade el grupo de capas al mapa
    }); // se cierra el evento para botón temático artístico
	
        // Evento para botón temático deportivo
        document.getElementById("radiodeportivo").addEventListener('click', function(event) { // si se presiona el botón con el id
          // Definición de referencias de filtro
            var clase = 'tematico'; // clase_filtro
            var tipo = 'deportivo';//tipo_filtro
          // se realiza una petición asíncrona para enviar las referencias 
          $.ajax({
                      url:"location_filtro.php", //archivo de destino
                      method: "POST", // método de petición
                      data:{lat,lng,clase,tipo}, // referencias
                      dataType:"text" // tipo de datos
                      }); // se cierra la petición asíncrona
          myData.clearLayers(); // el grupo de capas se limpia
          visor.removeLayer(myData); // se borra el grupo de capas sobre el mapa
          // definición de la variable que contendrá la nueva clase geojson                  		
          var deportivo;
          // se le añade una clase geojson de leaflet
            deportivo =L.geoJson(null, {  //se declara la clase vacía
                  pointToLayer: pt, // función pointtolayer definida más arriba
                  onEachFeature: oef, // función oneachfeature definida más arriba      
                  filter:function(feature, layer) { // función de filtro tipos de evento deportivo 
                    return (feature.properties.tipo_evento == "11"|| 
                            feature.properties.tipo_evento == "12"||
                            feature.properties.tipo_evento == "13"||
                            feature.properties.tipo_evento == "14"||
                            feature.properties.tipo_evento == "15"||
                            feature.properties.tipo_evento == "16");
                                                  }});// se cierra la clase geojson
          // llamada para cargar los datos mediante una solicitud GET HTTP a la url definida más arriba.        
          $.getJSON(URL, function(data) { // función de llamada  
          // se carga los datos provenientes de la peticion $.getJSON a la variable con la clase geojson sin datos de más arriba
          deportivo.addData(data); // función para añadir datos de una petición sobre una clase geojson ya definida                  
                 }); // se cierra la petición  $.getJSON
	        myData.addLayer(deportivo);// se añade la capa al grupo de capas
          myData.addTo(visor); // se añade el grupo de capas al mapa
                }); // se cierra el evento para botón temático deportivo

     // Evento para botón temático formativo
    document.getElementById("radioformativo").addEventListener('click', function(event) {// si se presiona el botón con el id
          // Definición de referencias de filtro
            var clase = 'tematico'; // clase_filtro
            var tipo = 'formativo';//tipo_filtro
          // se realiza una petición asíncrona para enviar las referencias 
          $.ajax({
                      url:"location_filtro.php", //archivo de destino
                      method: "POST", // método de petición
                      data:{lat,lng,clase,tipo}, // referencias
                      dataType:"text" // tipo de datos
                      }); // se cierra la petición asíncrona
          myData.clearLayers(); // el grupo de capas se limpia
          visor.removeLayer(myData); // se borra el grupo de capas sobre el mapa
          // definición de la variable que contendrá la nueva clase geojson                  		
		      var formativo;
          // se le añade una clase geojson de leaflet
              formativo =L.geoJson(null, {  //se declara la clase vacía
                  pointToLayer: pt, // función pointtolayer definida más arriba
                  onEachFeature: oef, // función oneachfeature definida más arriba      
                  filter:function(feature, layer) { // función de filtro tipos de evento formativo 
                    return (feature.properties.tipo_evento == "17"|| 
                            feature.properties.tipo_evento == "18"||
                            feature.properties.tipo_evento == "19"||
                            feature.properties.tipo_evento == "20"||
                            feature.properties.tipo_evento == "21"||
                            feature.properties.tipo_evento == "22");
                          }});// se cierra la clase geojson
          // llamada para cargar los datos mediante una solicitud GET HTTP a la url definida más arriba.        
          $.getJSON(URL, function(data) { // función de llamada  
          // se carga los datos provenientes de la peticion $.getJSON a la variable con la clase geojson sin datos de más arriba
          formativo.addData(data); // función para añadir datos de una petición sobre una clase geojson ya definida                  
                 }); // se cierra la petición  $.getJSON
	        myData.addLayer(formativo);// se añade la capa al grupo de capas
          myData.addTo(visor); // se añade el grupo de capas al mapa
                }); // se cierra el evento para botón temático formativo

     // Evento para botón temático medioambiental
     document.getElementById("radiomedioambiental").addEventListener('click', function(event) {// si se presiona el botón con el id
          // Definición de referencias de filtro
            var clase = 'tematico'; // clase_filtro
            var tipo = 'medioambiental';//tipo_filtro
          // se realiza una petición asíncrona para enviar las referencias 
          $.ajax({
                      url:"location_filtro.php", //archivo de destino
                      method: "POST", // método de petición
                      data:{lat,lng,clase,tipo}, // referencias
                      dataType:"text" // tipo de datos
                      }); // se cierra la petición asíncrona
          myData.clearLayers(); // el grupo de capas se limpia
          visor.removeLayer(myData); // se borra el grupo de capas sobre el mapa
          // definición de la variable que contendrá la nueva clase geojson                
		      var medioambiental;
            // se le añade una clase geojson de leaflet
            medioambiental =L.geoJson(null, {  //se declara la clase vacía
                  pointToLayer: pt, // función pointtolayer definida más arriba
                  onEachFeature: oef, // función oneachfeature definida más arriba      
                  filter:function(feature, layer) { // función de filtro tipos de evento medioambiental  
                return (feature.properties.tipo_evento == "23"|| 
                        feature.properties.tipo_evento == "24");
                                                  }});// se cierra la clase geojson
          // llamada para cargar los datos mediante una solicitud GET HTTP a la url definida más arriba.        
          $.getJSON(URL, function(data) { // función de llamada  
          // se carga los datos provenientes de la peticion $.getJSON a la variable con la clase geojson sin datos de más arriba
          medioambiental.addData(data); // función para añadir datos de una petición sobre una clase geojson ya definida                  
                 }); // se cierra la petición  $.getJSON
	        myData.addLayer(medioambiental);// se añade la capa al grupo de capas
          myData.addTo(visor); // se añade el grupo de capas al mapa
                }); // se cierra el evento para botón temático medioambiental


     // Evento para botón temático reivindicativo
     document.getElementById("radiorevindicativo").addEventListener('click', function(event) {// si se presiona el botón con el id
          // Definición de referencias de filtro
            var clase = 'tematico'; // clase_filtro
            var tipo = 'reivindicativo';//tipo_filtro
          // se realiza una petición asíncrona para enviar las referencias 
          $.ajax({
                      url:"location_filtro.php", //archivo de destino
                      method: "POST", // método de petición
                      data:{lat,lng,clase,tipo}, // referencias
                      dataType:"text" // tipo de datos
                      }); // se cierra la petición asíncrona
          myData.clearLayers(); // el grupo de capas se limpia
          visor.removeLayer(myData); // se borra el grupo de capas sobre el mapa
          // definición de la variable que contendrá la nueva clase geojson                		
	      	var revindicativo;
          // se le añade una clase geojson de leaflet
              reivindicativo =L.geoJson(null, {  //se declara la clase vacía
                  pointToLayer: pt, // función pointtolayer definida más arriba
                  onEachFeature: oef, // función oneachfeature definida más arriba      
                  filter:function(feature, layer) { // función de filtro tipos de evento reivindicativo  
                    return (feature.properties.tipo_evento == "25"|| 
                        feature.properties.tipo_evento == "26"||
                        feature.properties.tipo_evento == "27"||
                        feature.properties.tipo_evento == "28");
		                                            	}});// se cierra la clase geojson
          // llamada para cargar los datos mediante una solicitud GET HTTP a la url definida más arriba.        
          $.getJSON(URL, function(data) { // función de llamada  
          // se carga los datos provenientes de la peticion $.getJSON a la variable con la clase geojson sin datos de más arriba
          reivindicativo.addData(data); // función para añadir datos de una petición sobre una clase geojson ya definida                  
                 }); // se cierra la petición  $.getJSON
	        myData.addLayer(reivindicativo);// se añade la capa al grupo de capas
          myData.addTo(visor); // se añade el grupo de capas al mapa
                }); // se cierra el evento para botón temático reivindicativo

          // Evento para botón temporal 24h
          document.getElementById("radio24").addEventListener('click', function(event) {// si se presiona el botón con el id
          // Definición de referencias de filtro
            var clase = 'temporal'; // clase_filtro
            var tipo = '1';//tipo_filtro
          // se realiza una petición asíncrona para enviar las referencias 
          $.ajax({
                      url:"location_filtro.php", //archivo de destino
                      method: "POST", // método de petición
                      data:{lat,lng,clase,tipo}, // referencias
                      dataType:"text" // tipo de datos
                      }); // se cierra la petición asíncrona
          myData.clearLayers(); // el grupo de capas se limpia
          visor.removeLayer(myData); // se borra el grupo de capas sobre el mapa
          // definición de la variable que contendrá la nueva clase geojson                		
		      var manana;
                // se le añade una clase geojson de leaflet
                manana =L.geoJson(null, {  //se declara la clase vacía
                  pointToLayer: pt, // función pointtolayer definida más arriba
                  onEachFeature: oef, // función oneachfeature definida más arriba      
                  filter:function(feature, layer) { // función de filtro tipos de evento 24h                      
                    var today = new Date(); // variable con nueva fecha
                    var tomorrow = new Date(); // variable con fecha de hoy
                    tomorrow.setDate(today.getDate()+1); // alimenta variable con fecha de hoy + 1 día
                    var ahora = today.toISOString(); // convertir formato ISO
                    var man = tomorrow.toISOString();  // convertir formato ISO
                    return (man >= feature.properties.inicio_evento);
                                                  }});// se cierra la clase geojson
                // llamada para cargar los datos mediante una solicitud GET HTTP a la url definida más arriba.        
                $.getJSON(URL, function(data) { // función de llamada  
                // se carga los datos provenientes de la peticion $.getJSON a la variable con la clase geojson sin datos de más arriba
                manana.addData(data); // función para añadir datos de una petición sobre una clase geojson ya definida                  
                      }); // se cierra la petición  $.getJSON
                myData.addLayer(manana);// se añade la capa al grupo de capas
                myData.addTo(visor); // se añade el grupo de capas al mapa
                      }); // se cierra el evento para botón temporal 24h

          // Evento para botón temporal 48h
          document.getElementById("radio48").addEventListener('click', function(event) {// si se presiona el botón con el id
          // Definición de referencias de filtro
            var clase = 'temporal'; // clase_filtro
            var tipo = '2';//tipo_filtro
          // se realiza una petición asíncrona para enviar las referencias 
          $.ajax({
                      url:"location_filtro.php", //archivo de destino
                      method: "POST", // método de petición
                      data:{lat,lng,clase,tipo}, // referencias
                      dataType:"text" // tipo de datos
                      }); // se cierra la petición asíncrona
          myData.clearLayers(); // el grupo de capas se limpia
          visor.removeLayer(myData); // se borra el grupo de capas sobre el mapa
          // definición de la variable que contendrá la nueva clase geojson                	
		        var pmanana;
          // se le añade una clase geojson de leaflet
                pmanana =L.geoJson(null, {  //se declara la clase vacía
                  pointToLayer: pt, // función pointtolayer definida más arriba
                  onEachFeature: oef, // función oneachfeature definida más arriba      
                  filter:function(feature, layer) { // función de filtro tipos de evento 48h
                    var today = new Date(); // variable con nueva fecha
                    var ptomorrow = new Date(); // variable con fecha de hoy
                    ptomorrow.setDate(today.getDate()+2); // alimenta variable con fecha de hoy + 2 días
                    var ahora = today.toISOString(); // convertir formato ISO
                    var pman = ptomorrow.toISOString();  // convertir formato ISO 
                    return (pman >= feature.properties.inicio_evento);
                                                    }});// se cierra la clase geojson
                // llamada para cargar los datos mediante una solicitud GET HTTP a la url definida más arriba.        
                $.getJSON(URL, function(data) { // función de llamada  
                // se carga los datos provenientes de la peticion $.getJSON a la variable con la clase geojson sin datos de más arriba
                pmanana.addData(data); // función para añadir datos de una petición sobre una clase geojson ya definida                  
                      }); // se cierra la petición  $.getJSON
                myData.addLayer(pmanana);// se añade la capa al grupo de capas
                myData.addTo(visor); // se añade el grupo de capas al mapa
                      }); // se cierra el evento para botón temporal 48h
                    
          // Evento para botón temporal semana
          document.getElementById("radiosemana").addEventListener('click', function(event) {// si se presiona el botón con el id
          // Definición de referencias de filtro
            var clase = 'temporal'; // clase_filtro
            var tipo = '7';//tipo_filtro
          // se realiza una petición asíncrona para enviar las referencias 
          $.ajax({
                      url:"location_filtro.php", //archivo de destino
                      method: "POST", // método de petición
                      data:{lat,lng,clase,tipo}, // referencias
                      dataType:"text" // tipo de datos
                      }); // se cierra la petición asíncrona
          myData.clearLayers(); // el grupo de capas se limpia
          visor.removeLayer(myData); // se borra el grupo de capas sobre el mapa
          // definición de la variable que contendrá la nueva clase geojson                
    		    var semana;
          // se le añade una clase geojson de leaflet
              semana =L.geoJson(null, {  //se declara la clase vacía
                  pointToLayer: pt, // función pointtolayer definida más arriba
                  onEachFeature: oef, // función oneachfeature definida más arriba      
                  filter:function(feature, layer) { // función de filtro tipos de evento semana
                    var today = new Date(); // variable con nueva fecha
                    var week = new Date(); // variable con fecha de hoy
                    week.setDate(today.getDate()+7); // alimenta variable con fecha de hoy + 7 días
                    var ahora = today.toISOString(); // convertir formato ISO
                    var seman = week.toISOString();  // convertir formato ISO   
                    return (seman >= feature.properties.inicio_evento);
                                                  }});// se cierra la clase geojson
                    // llamada para cargar los datos mediante una solicitud GET HTTP a la url definida más arriba.        
                    $.getJSON(URL, function(data) { // función de llamada  
                    // se carga los datos provenientes de la peticion $.getJSON a la variable con la clase geojson sin datos de más arriba
                    semana.addData(data); // función para añadir datos de una petición sobre una clase geojson ya definida                  
                          }); // se cierra la petición  $.getJSON
                    myData.addLayer(semana);// se añade la capa al grupo de capas
                    myData.addTo(visor); // se añade el grupo de capas al mapa
                          }); // se cierra el evento para botón temporal semana

        // Evento para botón espacial 1 km
        document.getElementById("radiounokm").addEventListener('click', function(event) {// si se presiona el botón con el id
              // Definición de referencias de filtro
                var clase = 'espacial'; // clase_filtro
                var tipo = '1';//tipo_filtro
              // se realiza una petición asíncrona para enviar las referencias 
              $.ajax({
                          url:"location_filtro.php", //archivo de destino
                          method: "POST", // método de petición
                          data:{lat,lng,clase,tipo}, // referencias
                          dataType:"text" // tipo de datos
                          }); // se cierra la petición asíncrona
              myData.clearLayers(); // el grupo de capas se limpia
              visor.removeLayer(myData); // se borra el grupo de capas sobre el mapa
              // definición de la variable que contendrá la nueva clase geojson                
              var unokm;
              // se le añade una clase geojson de leaflet
                unokm =L.geoJson(null, {  //se declara la clase vacía
                  pointToLayer: pt, // función pointtolayer definida más arriba
                  onEachFeature: oef, // función oneachfeature definida más arriba      
                  filter:function(feature, layer) { // función de filtro tipos de evento 1km
                  var center = turf.point([lng,lat]); // declara variable local de posición de usuario 
                      return (turf.distance(center, feature.geometry.coordinates) <= 1 ); // condición que la distancia hasta center sea menor que 1 km         
                    }});// se cierra la clase geojson
                    // llamada para cargar los datos mediante una solicitud GET HTTP a la url definida más arriba.        
                    $.getJSON(URL, function(data) { // función de llamada  
                    // se carga los datos provenientes de la peticion $.getJSON a la variable con la clase geojson sin datos de más arriba
                    unokm.addData(data); // función para añadir datos de una petición sobre una clase geojson ya definida                  
                          }); // se cierra la petición  $.getJSON
                    myData.addLayer(unokm);// se añade la capa al grupo de capas
                    myData.addTo(visor); // se añade el grupo de capas al mapa
                          }); // se cierra el evento para botón espacial 1km

          // Evento para botón espacial 2 km
          document.getElementById("radiodoskm").addEventListener('click', function(event) {// si se presiona el botón con el id
              // Definición de referencias de filtro
                var clase = 'espacial'; // clase_filtro
                var tipo = '2';//tipo_filtro
              // se realiza una petición asíncrona para enviar las referencias 
              $.ajax({
                          url:"location_filtro.php", //archivo de destino
                          method: "POST", // método de petición
                          data:{lat,lng,clase,tipo}, // referencias
                          dataType:"text" // tipo de datos
                          }); // se cierra la petición asíncrona
              myData.clearLayers(); // el grupo de capas se limpia
              visor.removeLayer(myData); // se borra el grupo de capas sobre el mapa
              // definición de la variable que contendrá la nueva clase geojson               
             var doskm;
              // se le añade una clase geojson de leaflet
                  doskm =L.geoJson(null, {  //se declara la clase vacía
                          pointToLayer: pt, // función pointtolayer definida más arriba
                          onEachFeature: oef, // función oneachfeature definida más arriba      
                          filter:function(feature, layer) { // función de filtro tipos de evento 2km
                  var center = turf.point([lng,lat]); // declara variable local de posición de usuario 
                      return (turf.distance(center, feature.geometry.coordinates) <= 2 ); // condición que la distancia hasta center sea menor que 2 km         
                    }});// se cierra la clase geojson
                    // llamada para cargar los datos mediante una solicitud GET HTTP a la url definida más arriba.        
                    $.getJSON(URL, function(data) { // función de llamada  
                    // se carga los datos provenientes de la peticion $.getJSON a la variable con la clase geojson sin datos de más arriba
                    doskm.addData(data); // función para añadir datos de una petición sobre una clase geojson ya definida                  
                          }); // se cierra la petición  $.getJSON
                    myData.addLayer(doskm);// se añade la capa al grupo de capas
                    myData.addTo(visor); // se añade el grupo de capas al mapa
                          }); // se cierra el evento para botón espacial 2km

        // Evento para botón espacial 5 km
        document.getElementById("radiocincokm").addEventListener('click', function(event) {// si se presiona el botón con el id
              // Definición de referencias de filtro
                var clase = 'espacial'; // clase_filtro
                var tipo = '5';//tipo_filtro
              // se realiza una petición asíncrona para enviar las referencias 
              $.ajax({
                          url:"location_filtro.php", //archivo de destino
                          method: "POST", // método de petición
                          data:{lat,lng,clase,tipo}, // referencias
                          dataType:"text" // tipo de datos
                          }); // se cierra la petición asíncrona
              myData.clearLayers(); // el grupo de capas se limpia
              visor.removeLayer(myData); // se borra el grupo de capas sobre el mapa
              // definición de la variable que contendrá la nueva clase geojson               
             var cincokm;
              // se le añade una clase geojson de leaflet
                  cincokm =L.geoJson(null, {  //se declara la clase vacía
                          pointToLayer: pt, // función pointtolayer definida más arriba
                          onEachFeature: oef, // función oneachfeature definida más arriba      
                          filter:function(feature, layer) { // función de filtro tipos de evento 5km
                  var center = turf.point([lng,lat]); // declara variable local de posición de usuario 
                      return (turf.distance(center, feature.geometry.coordinates) <= 5 ); // condición que la distancia hasta center sea menor que 5 km         
                    }});// se cierra la clase geojson
                    // llamada para cargar los datos mediante una solicitud GET HTTP a la url definida más arriba.        
                    $.getJSON(URL, function(data) { // función de llamada  
                    // se carga los datos provenientes de la peticion $.getJSON a la variable con la clase geojson sin datos de más arriba
                    cincokm.addData(data); // función para añadir datos de una petición sobre una clase geojson ya definida                  
                          }); // se cierra la petición  $.getJSON
                    myData.addLayer(cincokm);// se añade la capa al grupo de capas
                    myData.addTo(visor); // se añade el grupo de capas al mapa
                          }); // se cierra el evento para botón espacial 2km
        </script>
</html>